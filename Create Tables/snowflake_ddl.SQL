-- ===================================================
-- Create Database & Schemas
-- ===================================================
CREATE OR REPLACE DATABASE SUPPLYCHAIN_ANALYTICS;

CREATE OR REPLACE SCHEMA SUPPLYCHAIN_ANALYTICS.scm_silver;
CREATE OR REPLACE SCHEMA SUPPLYCHAIN_ANALYTICS.scm_gold;

CREATE OR REPLACE TABLE SUPPLYCHAIN_ANALYTICS.SCM_SILVER.FACT_SALES_ORDER (
    SALESORDERNUMBER STRING,
    CREATEDDATE DATE,
    PROCESSEDDATE DATE,
    QUANTITY INT,
    UNITPRICE FLOAT,
    TAXAMOUNT FLOAT,
    CUSTOMER_ID INT,
    PRODUCT_ID INT,
    SUPPLIER_ID STRING,
    WAREHOUSE_ID STRING
);

CREATE OR REPLACE TABLE SUPPLYCHAIN_ANALYTICS.SCM_SILVER.FACT_INVENTORY (
    INVENTORY_ID STRING,
    PRODUCT_ID STRING,
    WAREHOUSE_ID STRING,
    STOCK_LEVEL BIGINT,
    LAST_UPDATED TIMESTAMP_NTZ,
    DAILY_USAGE_RATE FLOAT,
    INVENTORY_STATUS STRING,
    LAST_MOVEMENT_DATE DATE,
    PRODUCT_CATEGORY STRING,
    REORDER_POINT BIGINT,
    SKU_NAME STRING,
    SUPPLIER_ID STRING,
    UNIT_COST FLOAT
);


CREATE OR REPLACE TABLE SUPPLYCHAIN_ANALYTICS.SCM_SILVER.FACT_SHIPMENTS (
    SHIPMENT_ID STRING,
    SALESORDERNUMBER STRING,
    SHIPMENT_DATE DATE,
    DELIVERY_STATUS STRING,
    EXPECTED_DELIVERY_DATE DATE,
    ACTUAL_DELIVERY_DATE DATE,
    CARRIER_NAME STRING,
    DELIVERY_LOCATION STRING,
    PRODUCT_ID STRING,
    PROMISED_DELIVERY_DATE DATE,
    PURCHASE_ORDER_ID STRING,
    QUANTITY_SHIPPED BIGINT,
    SHIPPING_COST FLOAT,
    SUPPLIER_ID STRING
);
